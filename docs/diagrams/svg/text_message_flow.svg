<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="2597px" preserveAspectRatio="none" style="width:2357px;height:2597px;background:#FFFFFF;" version="1.1" viewBox="0 0 2357 2597" width="2357px" zoomAndPan="magnify"><defs/><g><rect fill="#FFFFFF" height="316.9932" style="stroke:#000000;stroke-width:1.0;" width="10" x="200" y="114.814"/><rect fill="#FFFFFF" height="287.1938" style="stroke:#000000;stroke-width:1.0;" width="10" x="456" y="144.6133"/><rect fill="#FFFFFF" height="1000.7134" style="stroke:#000000;stroke-width:1.0;" width="10" x="668" y="582.9717"/><rect fill="#FFFFFF" height="702.1216" style="stroke:#000000;stroke-width:1.0;" width="10" x="866" y="714.1689"/><rect fill="#FFFFFF" height="111.9966" style="stroke:#000000;stroke-width:1.0;" width="10" x="1106" y="751.9683"/><rect fill="#FFFFFF" height="484.7271" style="stroke:#000000;stroke-width:1.0;" width="10" x="1245.5" y="901.7642"/><rect fill="#FFFFFF" height="164.7959" style="stroke:#000000;stroke-width:1.0;" width="10" x="1449.5" y="986.1621"/><rect fill="#FFFFFF" height="89.3979" style="stroke:#000000;stroke-width:1.0;" width="10" x="1687.5" y="1031.7607"/><rect fill="#FFFFFF" height="89.3979" style="stroke:#000000;stroke-width:1.0;" width="10" x="1687.5" y="1948.7808"/><rect fill="#FFFFFF" height="29.7993" style="stroke:#000000;stroke-width:1.0;" width="10" x="1897" y="1061.5601"/><rect fill="#FFFFFF" height="29.7993" style="stroke:#000000;stroke-width:1.0;" width="10" x="1897" y="1978.5801"/><rect fill="#FFFFFF" height="29.7993" style="stroke:#000000;stroke-width:1.0;" width="10" x="2069" y="1701.481"/><rect fill="#FFFFFF" height="29.7993" style="stroke:#000000;stroke-width:1.0;" width="10" x="2069" y="2205.7739"/><rect fill="#FFFFFF" height="29.7993" style="stroke:#000000;stroke-width:1.0;" width="10" x="2236.5" y="2319.7705"/><rect fill="#FFFFFF" height="2179.1572" rx="10" ry="10" style="stroke:#000000;stroke-width:1.0;" width="2335.5" x="15" y="319.6099"/><path d="M15,439.8071 L2350.5,439.8071 L2350.5,2488.7671 A10,10 0 0 1 2340.5,2498.7671 L25,2498.7671 A10,10 0 0 1 15,2488.7671 L15,439.8071 " fill="#FFFFFF" style="stroke:none;stroke-width:1.0;"/><rect fill="#FFFFFF" height="420.1284" rx="10" ry="10" style="stroke:#000000;stroke-width:1.0;" width="1226.5" x="789" y="921.7642"/><rect fill="#FFFFFF" height="388.3291" rx="10" ry="10" style="stroke:#000000;stroke-width:1.0;" width="1206.5" x="799" y="946.5635"/><path d="M799,1158.958 L2005.5,1158.958 L2005.5,1236.9253 A10,10 0 0 1 1995.5,1246.9253 L809,1246.9253 A10,10 0 0 1 799,1236.9253 L799,1158.958 " fill="#FFFFFF" style="stroke:none;stroke-width:1.0;"/><path d="M799,1246.9253 L2005.5,1246.9253 L2005.5,1324.8926 A10,10 0 0 1 1995.5,1334.8926 L809,1334.8926 A10,10 0 0 1 799,1324.8926 L799,1246.9253 " fill="#FFFFFF" style="stroke:none;stroke-width:1.0;"/><rect fill="#FFFFFF" height="788.6841" rx="10" ry="10" style="stroke:#000000;stroke-width:1.0;" width="2315.5" x="25" y="1598.6851"/><path d="M25,1769.0796 L2340.5,1769.0796 L2340.5,2377.3691 A10,10 0 0 1 2330.5,2387.3691 L35,2387.3691 A10,10 0 0 1 25,2377.3691 L25,1769.0796 " fill="#FFFFFF" style="stroke:none;stroke-width:1.0;"/><rect fill="#FFFFFF" height="254.7305" rx="10" ry="10" style="stroke:#000000;stroke-width:1.0;" width="1654" x="351.5" y="1791.4482"/><rect fill="#FFFFFF" height="140.5952" rx="10" ry="10" style="stroke:#000000;stroke-width:1.0;" width="1801" x="351.5" y="2102.978"/><rect fill="#FFFFFF" height="90.3979" rx="10" ry="10" style="stroke:#000000;stroke-width:1.0;" width="634" x="25" y="2401.3691"/><line style="stroke:#000000;stroke-width:1.0;" x1="54" x2="54" y1="83.0146" y2="2515.7671"/><line style="stroke:#000000;stroke-width:1.0;" x1="204.5" x2="204.5" y1="83.0146" y2="2515.7671"/><line style="stroke:#000000;stroke-width:1.0;" x1="460.5" x2="460.5" y1="83.0146" y2="2515.7671"/><line style="stroke:#000000;stroke-width:1.0;" x1="673" x2="673" y1="83.0146" y2="2515.7671"/><line style="stroke:#000000;stroke-width:1.0;" x1="871" x2="871" y1="83.0146" y2="2515.7671"/><line style="stroke:#000000;stroke-width:1.0;" x1="1110.5" x2="1110.5" y1="83.0146" y2="2515.7671"/><line style="stroke:#000000;stroke-width:1.0;" x1="1250.5" x2="1250.5" y1="83.0146" y2="2515.7671"/><line style="stroke:#000000;stroke-width:1.0;" x1="1454" x2="1454" y1="83.0146" y2="2515.7671"/><line style="stroke:#000000;stroke-width:1.0;" x1="1692.5" x2="1692.5" y1="83.0146" y2="2515.7671"/><line style="stroke:#000000;stroke-width:1.0;" x1="1901.5" x2="1901.5" y1="83.0146" y2="2515.7671"/><line style="stroke:#000000;stroke-width:1.0;" x1="2073.5" x2="2073.5" y1="83.0146" y2="2515.7671"/><line style="stroke:#000000;stroke-width:1.0;" x1="2241.5" x2="2241.5" y1="83.0146" y2="2515.7671"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="32" x="35" y="80.0752">User</text><ellipse cx="54" cy="14" fill="#FFFFFF" rx="8" ry="8" style="stroke:#000000;stroke-width:1.0;"/><path d="M54,22 L54,49 M41,30 L67,30 M54,49 L41,64 M54,49 L67,64 " fill="none" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="32" x="35" y="2528.8423">User</text><ellipse cx="54" cy="2540.7817" fill="#FFFFFF" rx="8" ry="8" style="stroke:#000000;stroke-width:1.0;"/><path d="M54,2548.7817 L54,2575.7817 M41,2556.7817 L67,2556.7817 M54,2575.7817 L41,2590.7817 M54,2575.7817 L67,2590.7817 " fill="none" style="stroke:#000000;stroke-width:1.0;"/><rect fill="#FFFFFF" height="48.0293" rx="10" ry="10" style="stroke:#000000;stroke-width:1.0;" width="133" x="138.5" y="33.9854"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="94" x="158" y="55.0605">Telegram Bot</text><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="119" x="145.5" y="72.0752">(planner_bot.py)</text><rect fill="#FFFFFF" height="48.0293" rx="10" ry="10" style="stroke:#000000;stroke-width:1.0;" width="133" x="138.5" y="2514.7671"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="94" x="158" y="2535.8423">Telegram Bot</text><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="119" x="145.5" y="2552.8569">(planner_bot.py)</text><rect fill="#FFFFFF" height="48.0293" rx="10" ry="10" style="stroke:#000000;stroke-width:1.0;" width="179" x="371.5" y="33.9854"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="121" x="400.5" y="55.0605">MessageHandlers</text><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="165" x="378.5" y="72.0752">(message_handlers.py)</text><rect fill="#FFFFFF" height="48.0293" rx="10" ry="10" style="stroke:#000000;stroke-width:1.0;" width="179" x="371.5" y="2514.7671"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="121" x="400.5" y="2535.8423">MessageHandlers</text><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="165" x="378.5" y="2552.8569">(message_handlers.py)</text><rect fill="#FFFFFF" height="48.0293" rx="10" ry="10" style="stroke:#000000;stroke-width:1.0;" width="128" x="609" y="33.9854"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="80" x="633" y="55.0605">LLMHandler</text><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="114" x="616" y="72.0752">(llm_handler.py)</text><rect fill="#FFFFFF" height="48.0293" rx="10" ry="10" style="stroke:#000000;stroke-width:1.0;" width="128" x="609" y="2514.7671"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="80" x="633" y="2535.8423">LLMHandler</text><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="114" x="616" y="2552.8569">(llm_handler.py)</text><rect fill="#FFFFFF" height="48.0293" rx="10" ry="10" style="stroke:#000000;stroke-width:1.0;" width="104" x="819" y="33.9854"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="90" x="826" y="55.0605">Agent Graph</text><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="74" x="834" y="72.0752">(agent.py)</text><rect fill="#FFFFFF" height="48.0293" rx="10" ry="10" style="stroke:#000000;stroke-width:1.0;" width="104" x="819" y="2514.7671"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="90" x="826" y="2535.8423">Agent Graph</text><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="74" x="834" y="2552.8569">(agent.py)</text><rect fill="#FFFFFF" height="48.0293" rx="10" ry="10" style="stroke:#000000;stroke-width:1.0;" width="131" x="1045.5" y="33.9854"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="96" x="1063" y="55.0605">Planner Model</text><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="117" x="1052.5" y="72.0752">(Gemini/OpenAI)</text><rect fill="#FFFFFF" height="48.0293" rx="10" ry="10" style="stroke:#000000;stroke-width:1.0;" width="131" x="1045.5" y="2514.7671"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="96" x="1063" y="2535.8423">Planner Model</text><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="117" x="1052.5" y="2552.8569">(Gemini/OpenAI)</text><rect fill="#FFFFFF" height="48.0293" rx="10" ry="10" style="stroke:#000000;stroke-width:1.0;" width="88" x="1206.5" y="33.9854"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="63" x="1219" y="55.0605">Executor</text><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="74" x="1213.5" y="72.0752">(agent.py)</text><rect fill="#FFFFFF" height="48.0293" rx="10" ry="10" style="stroke:#000000;stroke-width:1.0;" width="88" x="1206.5" y="2514.7671"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="63" x="1219" y="2535.8423">Executor</text><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="74" x="1213.5" y="2552.8569">(agent.py)</text><rect fill="#FFFFFF" height="48.0293" rx="10" ry="10" style="stroke:#000000;stroke-width:1.0;" width="149" x="1380" y="33.9854"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="104" x="1402.5" y="55.0605">Tool Wrappers</text><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="135" x="1387" y="72.0752">(tool_wrappers.py)</text><rect fill="#FFFFFF" height="48.0293" rx="10" ry="10" style="stroke:#000000;stroke-width:1.0;" width="149" x="1380" y="2514.7671"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="104" x="1402.5" y="2535.8423">Tool Wrappers</text><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="135" x="1387" y="2552.8569">(tool_wrappers.py)</text><rect fill="#FFFFFF" height="48.0293" rx="10" ry="10" style="stroke:#000000;stroke-width:1.0;" width="192" x="1596.5" y="33.9854"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="130" x="1627.5" y="55.0605">PlannerAPIAdapter</text><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="178" x="1603.5" y="72.0752">(planner_api_adapter.py)</text><rect fill="#FFFFFF" height="48.0293" rx="10" ry="10" style="stroke:#000000;stroke-width:1.0;" width="192" x="1596.5" y="2514.7671"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="130" x="1627.5" y="2535.8423">PlannerAPIAdapter</text><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="178" x="1603.5" y="2552.8569">(planner_api_adapter.py)</text><rect fill="#FFFFFF" height="48.0293" rx="10" ry="10" style="stroke:#000000;stroke-width:1.0;" width="167" x="1818.5" y="33.9854"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="87" x="1858.5" y="55.0605">Repositories</text><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="153" x="1825.5" y="72.0752">(promises_repo, etc.)</text><rect fill="#FFFFFF" height="48.0293" rx="10" ry="10" style="stroke:#000000;stroke-width:1.0;" width="167" x="1818.5" y="2514.7671"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="87" x="1858.5" y="2535.8423">Repositories</text><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="153" x="1825.5" y="2552.8569">(promises_repo, etc.)</text><rect fill="#FFFFFF" height="48.0293" rx="10" ry="10" style="stroke:#000000;stroke-width:1.0;" width="117" x="2015.5" y="33.9854"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="72" x="2038" y="55.0605">Translator</text><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="103" x="2022.5" y="72.0752">(translator.py)</text><rect fill="#FFFFFF" height="48.0293" rx="10" ry="10" style="stroke:#000000;stroke-width:1.0;" width="117" x="2015.5" y="2514.7671"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="72" x="2038" y="2535.8423">Translator</text><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="103" x="2022.5" y="2552.8569">(translator.py)</text><rect fill="#FFFFFF" height="48.0293" rx="10" ry="10" style="stroke:#000000;stroke-width:1.0;" width="158" x="2162.5" y="33.9854"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="144" x="2169.5" y="55.0605">Response Formatter</text><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="108" x="2187.5" y="72.0752">(formatting.py)</text><rect fill="#FFFFFF" height="48.0293" rx="10" ry="10" style="stroke:#000000;stroke-width:1.0;" width="158" x="2162.5" y="2514.7671"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="144" x="2169.5" y="2535.8423">Response Formatter</text><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="108" x="2187.5" y="2552.8569">(formatting.py)</text><rect fill="#FFFFFF" height="316.9932" style="stroke:#000000;stroke-width:1.0;" width="10" x="200" y="114.814"/><rect fill="#FFFFFF" height="287.1938" style="stroke:#000000;stroke-width:1.0;" width="10" x="456" y="144.6133"/><rect fill="#FFFFFF" height="1000.7134" style="stroke:#000000;stroke-width:1.0;" width="10" x="668" y="582.9717"/><rect fill="#FFFFFF" height="702.1216" style="stroke:#000000;stroke-width:1.0;" width="10" x="866" y="714.1689"/><rect fill="#FFFFFF" height="111.9966" style="stroke:#000000;stroke-width:1.0;" width="10" x="1106" y="751.9683"/><rect fill="#FFFFFF" height="484.7271" style="stroke:#000000;stroke-width:1.0;" width="10" x="1245.5" y="901.7642"/><rect fill="#FFFFFF" height="164.7959" style="stroke:#000000;stroke-width:1.0;" width="10" x="1449.5" y="986.1621"/><rect fill="#FFFFFF" height="89.3979" style="stroke:#000000;stroke-width:1.0;" width="10" x="1687.5" y="1031.7607"/><rect fill="#FFFFFF" height="89.3979" style="stroke:#000000;stroke-width:1.0;" width="10" x="1687.5" y="1948.7808"/><rect fill="#FFFFFF" height="29.7993" style="stroke:#000000;stroke-width:1.0;" width="10" x="1897" y="1061.5601"/><rect fill="#FFFFFF" height="29.7993" style="stroke:#000000;stroke-width:1.0;" width="10" x="1897" y="1978.5801"/><rect fill="#FFFFFF" height="29.7993" style="stroke:#000000;stroke-width:1.0;" width="10" x="2069" y="1701.481"/><rect fill="#FFFFFF" height="29.7993" style="stroke:#000000;stroke-width:1.0;" width="10" x="2069" y="2205.7739"/><rect fill="#FFFFFF" height="29.7993" style="stroke:#000000;stroke-width:1.0;" width="10" x="2236.5" y="2319.7705"/><polygon fill="#000000" points="188,110.814,198,114.814,188,118.814,192,114.814" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="54" x2="194" y1="114.814" y2="114.814"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="127" x="63.5" y="110.0845">Send text message</text><polygon fill="#000000" points="444,140.6133,454,144.6133,444,148.6133,448,144.6133" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="210" x2="450" y1="144.6133" y2="144.6133"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="227" x="219.5" y="139.8838">handle_message(update, context)</text><line style="stroke:#000000;stroke-width:1.0;" x1="466" x2="508" y1="190.2119" y2="190.2119"/><line style="stroke:#000000;stroke-width:1.0;" x1="508" x2="508" y1="190.2119" y2="203.2119"/><line style="stroke:#000000;stroke-width:1.0;" x1="467" x2="508" y1="203.2119" y2="203.2119"/><polygon fill="#000000" points="477,199.2119,467,203.2119,477,207.2119,473,203.2119" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="116" x="479" y="169.6831">Check user exists</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="128" x="473" y="185.4824">(if not, call start())</text><line style="stroke:#000000;stroke-width:1.0;" x1="466" x2="508" y1="233.0112" y2="233.0112"/><line style="stroke:#000000;stroke-width:1.0;" x1="508" x2="508" y1="233.0112" y2="246.0112"/><line style="stroke:#000000;stroke-width:1.0;" x1="467" x2="508" y1="246.0112" y2="246.0112"/><polygon fill="#000000" points="477,242.0112,467,246.0112,477,250.0112,473,246.0112" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="177" x="473" y="228.2817">Check pending clarification</text><line style="stroke:#000000;stroke-width:1.0;" x1="466" x2="508" y1="291.6099" y2="291.6099"/><line style="stroke:#000000;stroke-width:1.0;" x1="508" x2="508" y1="291.6099" y2="304.6099"/><line style="stroke:#000000;stroke-width:1.0;" x1="467" x2="508" y1="304.6099" y2="304.6099"/><polygon fill="#000000" points="477,300.6099,467,304.6099,477,308.6099,473,304.6099" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="99" x="512.5" y="271.0811">Check for URLs</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="178" x="473" y="286.8804">(route to content_service)</text><path d="M25,319.6099 L79,319.6099 L79,327.4092 L69,337.4092 L15,337.4092 L15,329.6099 A10,10 0 0 1 25,319.6099 " fill="#FFFFFF" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="2179.1572" rx="10" ry="10" style="stroke:#000000;stroke-width:1.0;" width="2335.5" x="15" y="319.6099"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="30" y="333.6797">alt</text><text fill="#000000" font-family="Verdana" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="97" x="94" y="332.6689">[URL detected]</text><line style="stroke:#000000;stroke-width:1.0;" x1="466" x2="508" y1="359.2085" y2="359.2085"/><line style="stroke:#000000;stroke-width:1.0;" x1="508" x2="508" y1="359.2085" y2="372.2085"/><line style="stroke:#000000;stroke-width:1.0;" x1="467" x2="508" y1="372.2085" y2="372.2085"/><polygon fill="#000000" points="477,368.2085,467,372.2085,477,376.2085,473,372.2085" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="157" x="473" y="354.479">_handle_link_message()</text><polygon fill="#000000" points="1680.5,398.0078,1690.5,402.0078,1680.5,406.0078,1684.5,402.0078" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="466" x2="1686.5" y1="402.0078" y2="402.0078"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="92" x="1033.25" y="397.2783">process_link()</text><polygon fill="#000000" points="65,427.8071,55,431.8071,65,435.8071,61,431.8071" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="59" x2="460" y1="431.8071" y2="431.8071"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="122" x="196.5" y="427.0776">Send link summary</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="15" x2="2350.5" y1="440.8071" y2="440.8071"/><text fill="#000000" font-family="Verdana" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="151" x="20" y="451.8662">[Normal text message]</text><line style="stroke:#000000;stroke-width:1.0;" x1="461" x2="503" y1="476.9751" y2="476.9751"/><line style="stroke:#000000;stroke-width:1.0;" x1="503" x2="503" y1="476.9751" y2="489.9751"/><line style="stroke:#000000;stroke-width:1.0;" x1="462" x2="503" y1="489.9751" y2="489.9751"/><polygon fill="#000000" points="472,485.9751,462,489.9751,472,493.9751,468,489.9751" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="120" x="468" y="472.2456">Get user language</text><polygon fill="#000000" points="656,578.9717,666,582.9717,656,586.9717,660,582.9717" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="461" x2="662" y1="582.9717" y2="582.9717"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="122" x="503.5" y="515.0449">get_response_api(</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="98" x="520.5" y="530.8442">user_message,</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="52" x="543.5" y="546.6436">user_id,</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="95" x="522" y="562.4429">user_language</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="6" x="561.5" y="578.2422">)</text><line style="stroke:#000000;stroke-width:1.0;" x1="678" x2="720" y1="612.771" y2="612.771"/><line style="stroke:#000000;stroke-width:1.0;" x1="720" x2="720" y1="612.771" y2="625.771"/><line style="stroke:#000000;stroke-width:1.0;" x1="679" x2="720" y1="625.771" y2="625.771"/><polygon fill="#000000" points="689,621.771,679,625.771,689,629.771,685,625.771" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="142" x="685" y="608.0415">Build message history</text><line style="stroke:#000000;stroke-width:1.0;" x1="678" x2="720" y1="671.3696" y2="671.3696"/><line style="stroke:#000000;stroke-width:1.0;" x1="720" x2="720" y1="671.3696" y2="684.3696"/><line style="stroke:#000000;stroke-width:1.0;" x1="679" x2="720" y1="684.3696" y2="684.3696"/><polygon fill="#000000" points="689,680.3696,679,684.3696,689,688.3696,685,684.3696" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="125" x="701.5" y="650.8408">Create AgentState</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="158" x="685" y="666.6401">(messages, iteration=0)</text><polygon fill="#000000" points="854,710.1689,864,714.1689,854,718.1689,858,714.1689" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="678" x2="860" y1="714.1689" y2="714.1689"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="164" x="690" y="709.4395">agent_app.invoke(state)</text><line style="stroke:#000000;stroke-width:1.0;" x1="876" x2="923" y1="738.9683" y2="738.9683"/><line style="stroke:#000000;stroke-width:1.0;" x1="923" x2="923" y1="738.9683" y2="751.9683"/><line style="stroke:#000000;stroke-width:1.0;" x1="882" x2="923" y1="751.9683" y2="751.9683"/><polygon fill="#000000" points="892,747.9683,882,751.9683,892,755.9683,888,751.9683" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="95" x="888" y="734.2388">planner(state)</text><polygon fill="#000000" points="1094,814.3662,1104,818.3662,1094,822.3662,1098,818.3662" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="876" x2="1100" y1="818.3662" y2="818.3662"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="147" x="917.5" y="782.0381">planner_model.invoke(</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="184" x="904" y="797.8374">system_prompt + messages</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="6" x="988" y="813.6367">)</text><polygon fill="#000000" points="887,859.9648,877,863.9648,887,867.9648,883,863.9648" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="881" x2="1110" y1="863.9648" y2="863.9648"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="66" x="960.5" y="843.436">Plan JSON</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="206" x="890.5" y="859.2354">(steps: tool/respond/ask_user)</text><line style="stroke:#000000;stroke-width:1.0;" x1="876" x2="923" y1="888.7642" y2="888.7642"/><line style="stroke:#000000;stroke-width:1.0;" x1="923" x2="923" y1="888.7642" y2="901.7642"/><line style="stroke:#000000;stroke-width:1.0;" x1="882" x2="923" y1="901.7642" y2="901.7642"/><polygon fill="#000000" points="892,897.7642,882,901.7642,892,905.7642,888,901.7642" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="105" x="888" y="884.0347">executor(state)</text><path d="M799,921.7642 L865,921.7642 L865,929.5635 L855,939.5635 L789,939.5635 L789,931.7642 A10,10 0 0 1 799,921.7642 " fill="#FFFFFF" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="420.1284" rx="10" ry="10" style="stroke:#000000;stroke-width:1.0;" width="1226.5" x="789" y="921.7642"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="31" x="804" y="935.834">loop</text><text fill="#000000" font-family="Verdana" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="149" x="880" y="934.8232">[For each step in plan]</text><path d="M809,946.5635 L863,946.5635 L863,954.3628 L853,964.3628 L799,964.3628 L799,956.5635 A10,10 0 0 1 809,946.5635 " fill="#FFFFFF" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="388.3291" rx="10" ry="10" style="stroke:#000000;stroke-width:1.0;" width="1206.5" x="799" y="946.5635"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="814" y="960.6333">alt</text><text fill="#000000" font-family="Verdana" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="99" x="878" y="959.6226">[Step is "tool"]</text><polygon fill="#000000" points="1437.5,982.1621,1447.5,986.1621,1437.5,990.1621,1441.5,986.1621" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="1255.5" x2="1443.5" y1="986.1621" y2="986.1621"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="110" x="1297.5" y="981.4326">Execute tool call</text><polygon fill="#000000" points="1675.5,1027.7607,1685.5,1031.7607,1675.5,1035.7607,1679.5,1031.7607" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="1459.5" x2="1681.5" y1="1031.7607" y2="1031.7607"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="77" x="1535" y="1011.2319">Call method</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="209" x="1469" y="1027.0313">(add_promise, log_action, etc.)</text><polygon fill="#000000" points="1885,1057.5601,1895,1061.5601,1885,1065.5601,1889,1061.5601" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="1697.5" x2="1891" y1="1061.5601" y2="1061.5601"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="136" x="1729.25" y="1056.8306">Database operations</text><polygon fill="#000000" points="1708.5,1087.3594,1698.5,1091.3594,1708.5,1095.3594,1704.5,1091.3594" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1702.5" x2="1901" y1="1091.3594" y2="1091.3594"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="40" x="1779.75" y="1086.6299">Result</text><polygon fill="#000000" points="1470.5,1117.1587,1460.5,1121.1587,1470.5,1125.1587,1466.5,1121.1587" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1464.5" x2="1691.5" y1="1121.1587" y2="1121.1587"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="99" x="1526.5" y="1116.4292">Function result</text><polygon fill="#000000" points="1266.5,1146.958,1256.5,1150.958,1266.5,1154.958,1262.5,1150.958" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1260.5" x2="1453.5" y1="1150.958" y2="1150.958"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="134" x="1288" y="1146.2285">ToolMessage(result)</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="799" x2="2005.5" y1="1159.958" y2="1159.958"/><text fill="#000000" font-family="Verdana" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="134" x="804" y="1171.0171">[Step is "ask_user"]</text><line style="stroke:#000000;stroke-width:1.0;" x1="1255.5" x2="1297.5" y1="1196.126" y2="1196.126"/><line style="stroke:#000000;stroke-width:1.0;" x1="1297.5" x2="1297.5" y1="1196.126" y2="1209.126"/><line style="stroke:#000000;stroke-width:1.0;" x1="1256.5" x2="1297.5" y1="1209.126" y2="1209.126"/><polygon fill="#000000" points="1266.5,1205.126,1256.5,1209.126,1266.5,1213.126,1262.5,1209.126" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="163" x="1262.5" y="1191.3965">Set pending_clarification</text><polygon fill="#000000" points="887,1234.9253,877,1238.9253,887,1242.9253,883,1238.9253" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="881" x2="1244.5" y1="1238.9253" y2="1238.9253"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="151" x="985.25" y="1234.1958">State with clarification</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="799" x2="2005.5" y1="1247.9253" y2="1247.9253"/><text fill="#000000" font-family="Verdana" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="127" x="804" y="1258.9844">[Step is "respond"]</text><line style="stroke:#000000;stroke-width:1.0;" x1="1255.5" x2="1297.5" y1="1284.0933" y2="1284.0933"/><line style="stroke:#000000;stroke-width:1.0;" x1="1297.5" x2="1297.5" y1="1284.0933" y2="1297.0933"/><line style="stroke:#000000;stroke-width:1.0;" x1="1256.5" x2="1297.5" y1="1297.0933" y2="1297.0933"/><polygon fill="#000000" points="1266.5,1293.0933,1256.5,1297.0933,1266.5,1301.0933,1262.5,1297.0933" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="170" x="1262.5" y="1279.3638">responder_model.invoke()</text><polygon fill="#000000" points="887,1322.8926,877,1326.8926,887,1330.8926,883,1326.8926" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="881" x2="1244.5" y1="1326.8926" y2="1326.8926"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="94" x="1013.75" y="1322.1631">Final response</text><polygon fill="#000000" points="887,1382.4912,877,1386.4912,887,1390.4912,883,1386.4912" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="881" x2="1249.5" y1="1386.4912" y2="1386.4912"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="70" x="1028.25" y="1365.9624">Final state</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="200" x="963.25" y="1381.7617">(final_response, tool_outputs)</text><polygon fill="#000000" points="689,1412.2905,679,1416.2905,689,1420.2905,685,1416.2905" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="683" x2="870" y1="1416.2905" y2="1416.2905"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="80" x="734.5" y="1411.561">Result state</text><line style="stroke:#000000;stroke-width:1.0;" x1="678" x2="720" y1="1461.8892" y2="1461.8892"/><line style="stroke:#000000;stroke-width:1.0;" x1="720" x2="720" y1="1461.8892" y2="1474.8892"/><line style="stroke:#000000;stroke-width:1.0;" x1="679" x2="720" y1="1474.8892" y2="1474.8892"/><polygon fill="#000000" points="689,1470.8892,679,1474.8892,689,1478.8892,685,1474.8892" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="112" x="711" y="1441.3604">Extract response</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="164" x="685" y="1457.1597">and pending_clarification</text><polygon fill="#000000" points="472,1579.6851,462,1583.6851,472,1587.6851,468,1583.6851" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="466" x2="672" y1="1583.6851" y2="1583.6851"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="114" x="510" y="1499.959">llm_response dict</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="8" x="563" y="1515.7583">{</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="122" x="511" y="1531.5576">response_to_user,</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="136" x="504" y="1547.3569">executed_by_agent,</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="135" x="504.5" y="1563.1563">pending_clarification</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="8" x="563" y="1578.9556">}</text><path d="M35,1598.6851 L89,1598.6851 L89,1606.4844 L79,1616.4844 L25,1616.4844 L25,1608.6851 A10,10 0 0 1 35,1598.6851 " fill="#FFFFFF" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="788.6841" rx="10" ry="10" style="stroke:#000000;stroke-width:1.0;" width="2315.5" x="25" y="1598.6851"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="40" y="1612.7549">alt</text><text fill="#000000" font-family="Verdana" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="165" x="104" y="1611.7441">[LLM response has error]</text><polygon fill="#000000" points="2057,1697.481,2067,1701.481,2057,1705.481,2061,1701.481" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="461" x2="2063" y1="1701.481" y2="1701.481"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="100" x="1215" y="1633.5542">translate_text(</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="70" x="1235" y="1649.3535">error_msg,</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="81" x="1229.5" y="1665.1528">target_lang,</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="114" x="1213" y="1680.9521">source_lang="en"</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="6" x="1262" y="1696.7515">)</text><polygon fill="#000000" points="472,1727.2803,462,1731.2803,472,1735.2803,468,1731.2803" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="466" x2="2073" y1="1731.2803" y2="1731.2803"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="106" x="1214.5" y="1726.5508">Translated error</text><polygon fill="#000000" points="65,1757.0796,55,1761.0796,65,1765.0796,61,1761.0796" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="59" x2="460" y1="1761.0796" y2="1761.0796"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="131" x="192" y="1756.3501">Send error message</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="25" x2="2340.5" y1="1770.0796" y2="1770.0796"/><text fill="#000000" font-family="Verdana" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="123" x="30" y="1781.1387">[Normal response]</text><path d="M361.5,1791.4482 L415.5,1791.4482 L415.5,1799.2476 L405.5,1809.2476 L351.5,1809.2476 L351.5,1801.4482 A10,10 0 0 1 361.5,1791.4482 " fill="#FFFFFF" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="254.7305" rx="10" ry="10" style="stroke:#000000;stroke-width:1.0;" width="1654" x="351.5" y="1791.4482"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="366.5" y="1805.5181">alt</text><text fill="#000000" font-family="Verdana" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="191" x="430.5" y="1804.5073">[Tools not executed by agent</text><text fill="#000000" font-family="Verdana" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="101" x="430.5" y="1817.876">(legacy mode)]</text><line style="stroke:#000000;stroke-width:1.0;" x1="461" x2="503" y1="1890.1821" y2="1890.1821"/><line style="stroke:#000000;stroke-width:1.0;" x1="503" x2="503" y1="1890.1821" y2="1903.1821"/><line style="stroke:#000000;stroke-width:1.0;" x1="462" x2="503" y1="1903.1821" y2="1903.1821"/><polygon fill="#000000" points="472,1899.1821,462,1903.1821,472,1907.1821,468,1903.1821" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="111" x="468" y="1838.0547">call_planner_api(</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="52" x="502.5" y="1853.854">user_id,</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="84" x="486.5" y="1869.6533">llm_response</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="6" x="520.5" y="1885.4526">)</text><polygon fill="#000000" points="1675.5,1944.7808,1685.5,1948.7808,1675.5,1952.7808,1679.5,1948.7808" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="461" x2="1681.5" y1="1948.7808" y2="1948.7808"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="112" x="1018.25" y="1928.252">Execute function</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="196" x="976.25" y="1944.0513">(function_call, function_args)</text><polygon fill="#000000" points="1885,1974.5801,1895,1978.5801,1885,1982.5801,1889,1978.5801" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="1697.5" x2="1891" y1="1978.5801" y2="1978.5801"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="136" x="1729.25" y="1973.8506">Database operations</text><polygon fill="#000000" points="1708.5,2004.3794,1698.5,2008.3794,1708.5,2012.3794,1704.5,2008.3794" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1702.5" x2="1901" y1="2008.3794" y2="2008.3794"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="40" x="1779.75" y="2003.6499">Result</text><polygon fill="#000000" points="472,2034.1787,462,2038.1787,472,2042.1787,468,2038.1787" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="466" x2="1691.5" y1="2038.1787" y2="2038.1787"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="99" x="1027.25" y="2033.4492">Function result</text><line style="stroke:#000000;stroke-width:1.0;" x1="461" x2="503" y1="2074.978" y2="2074.978"/><line style="stroke:#000000;stroke-width:1.0;" x1="503" x2="503" y1="2074.978" y2="2087.978"/><line style="stroke:#000000;stroke-width:1.0;" x1="462" x2="503" y1="2087.978" y2="2087.978"/><polygon fill="#000000" points="472,2083.978,462,2087.978,472,2091.978,468,2087.978" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="147" x="468" y="2070.2485">Extract response_text</text><path d="M361.5,2102.978 L415.5,2102.978 L415.5,2110.7773 L405.5,2120.7773 L351.5,2120.7773 L351.5,2112.978 A10,10 0 0 1 361.5,2102.978 " fill="#FFFFFF" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="140.5952" rx="10" ry="10" style="stroke:#000000;stroke-width:1.0;" width="1801" x="351.5" y="2102.978"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="366.5" y="2117.0479">alt</text><text fill="#000000" font-family="Verdana" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="174" x="430.5" y="2116.0371">[User language != English]</text><polygon fill="#000000" points="2057,2201.7739,2067,2205.7739,2057,2209.7739,2061,2205.7739" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="461" x2="2063" y1="2205.7739" y2="2205.7739"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="100" x="1215" y="2137.8472">translate_text(</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="99" x="1220.5" y="2153.6465">response_text,</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="81" x="1229.5" y="2169.4458">target_lang,</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="114" x="1213" y="2185.2451">source_lang="en"</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="6" x="1262" y="2201.0444">)</text><polygon fill="#000000" points="472,2231.5732,462,2235.5732,472,2239.5732,468,2235.5732" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="466" x2="2073" y1="2235.5732" y2="2235.5732"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="134" x="1200.5" y="2230.8438">Translated response</text><polygon fill="#000000" points="2224.5,2315.7705,2234.5,2319.7705,2224.5,2323.7705,2228.5,2319.7705" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="461" x2="2230.5" y1="2319.7705" y2="2319.7705"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="152" x="1272.75" y="2267.6431">format_response_html(</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="99" x="1304.25" y="2283.4424">response_text,</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="126" x="1290.75" y="2299.2417">func_call_response</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="6" x="1345.75" y="2315.041">)</text><polygon fill="#000000" points="472,2345.5698,462,2349.5698,472,2353.5698,468,2349.5698" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="466" x2="2240.5" y1="2349.5698" y2="2349.5698"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="173" x="1264.75" y="2344.8403">Formatted HTML response</text><polygon fill="#000000" points="65,2375.3691,55,2379.3691,65,2383.3691,61,2379.3691" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="59" x2="460" y1="2379.3691" y2="2379.3691"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="167" x="174" y="2374.6396">Send formatted response</text><path d="M35,2401.3691 L89,2401.3691 L89,2409.1685 L79,2419.1685 L25,2419.1685 L25,2411.3691 A10,10 0 0 1 35,2401.3691 " fill="#FFFFFF" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="90.3979" rx="10" ry="10" style="stroke:#000000;stroke-width:1.0;" width="634" x="25" y="2401.3691"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="40" y="2415.439">alt</text><text fill="#000000" font-family="Verdana" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="189" x="104" y="2414.4282">[Pending clarification exists]</text><line style="stroke:#000000;stroke-width:1.0;" x1="461" x2="503" y1="2440.9678" y2="2440.9678"/><line style="stroke:#000000;stroke-width:1.0;" x1="503" x2="503" y1="2440.9678" y2="2453.9678"/><line style="stroke:#000000;stroke-width:1.0;" x1="462" x2="503" y1="2453.9678" y2="2453.9678"/><polygon fill="#000000" points="472,2449.9678,462,2453.9678,472,2457.9678,468,2453.9678" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="179" x="468" y="2436.2383">Store in context.user_data</text><polygon fill="#000000" points="65,2479.7671,55,2483.7671,65,2487.7671,61,2483.7671" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="59" x2="460" y1="2483.7671" y2="2483.7671"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="137" x="189" y="2479.0376">Ask for missing fields</text><!--SRC=[rLVVRziu37xFNy7bAS5bxN2F0Nf0rckx7jgjM3RSIm53jPb4g2tvBALhSDZ_VgGaop_Y9BrxkpwaDiMF8Ydo4_tERh10A7CXrSWyIrMAIXHWyAyjgXJlqHYnnaKkrmfIL1QhbbQbjofBTQMmWby_Z4OYjRg2xuQKIC7AL9P2MHX_mnpN3FYexQEQq6QA8CcJjcVbRZe6ONYbYmaxVn8gox4o12ky9Da4KSG6dIx-xku-o0cQvqKDYoXIw28MQueFRYfHRWWY-2qgkxMk-eEF0kvrXZa1Rh2GIfv_AL4jRZqgg7HnLw-ORYbFUtlK2xtSQPt3d-HKwRDWwJtv4TuZbhNCe7-BXzj59ahhyb1dNfGo4LxQXFXmspNm5Kjj93aaaJSkArr8WoQfI3u3jEcP1x9Up-TAA9CB7wIDBustKTJVqPHQ6OHhNHN2UfzN_bcgTSJ7vT68YmtU_yRrCuSbgWmilbe8jS8LAL-4HLTV8_fXtL0NS_0baGJboRRCI7K6gLPiPDgWwmeRXOUEbSiDfi-mPKVmLHhBoP8hKDgIAP7dO2m5EPbEZw2fQ3AA4D9SL78bKs6bLaVqLzndN-zuAsf2yj1gxxQo2Jdo8bESKZ_cbhKWGukfnMm4z3TaD3H7aalr7DCnxQjJXSo1oY0b1QUwhyB74Sw15S1iYq9KEwUMuLu-Us8-9Cpf_3_p0UVTeppa-mrQdtogxVLsG9CQVGvhj5Iulhou_2UF2Xoi3dSM1J9hdckRZyg76brbzc21-w6NkD77hSopscdOK3te47zRwx92jk9ePMdfiU4tCmD9fUqguEB3j0rrwdDmj451b6TIlUXdd1Ysq7FGCrPqqPDROoCmmI2qfgqEBWWZCYcOzseFE65cPomM2VD4QU6NEWUcpbrDcEyRBrW4Voo_VARm2LoQEJ2_dVkJoiw5UKxu7ARzIccxE1WV1Z8T330oROJdMfTCAq1RR81T0QbSg6xPeQcPbcx1m9Yz7CSb_gjjiW-EZUT1X2uanmGTGFJ6StTxoKbYnrqoXnHeDphZEoFBaa35Ct9xdR0ThG8X3-_0rDvUe7UspiGzXz-55K-2cawNeUhCi1N7y-qL5lZJP3U9lBUvxIYq3cmFx7neSdMzLIuEg8wQwKSICaLswlpFdInC3nDlRNh8N3VrZdhY4TUrT_YOcosNn461mfCkXGzZcpfrpGy_fDt0CB3hL6YCj_WKLFkTEZtfqhLKnBqrMJQEA7z_rFz7n_4ciDgAtoBrpbmp97HbbLjhzjfwlp53NzUywOlC6- -3UupNfjkhLvf2KXk3UbHqFHmvCOTjNp8yGDPWo6HAO-pVp7dnIh7Q5OkxEJptO9OyxHB7rKuwkDkZ-jaFetEpCEcmCt7l3Oq_M5KXHRsRhfchY4V3Cxb6jwWZQ8TB2hDs_j1GmfSYtt3ktUXjbQ9xlnYZ6jUqtUMgPdABBHX5tPJLSinw3hVxRz_Sy33XB7H6WVQSi5Uhd3PF3JI5nVE0fvs_E_cB0DSYtG6tHhSZXaOCvkwaDJjF-hD2kppQUHiQeEfROHKOZtiaF2QyqIok97H2vdz8wJ5l_u7KQtQ97N3eJFejxSgyKm3VsqCXlBk0AxNEfTaSEfqJtTFPw5ztqAakUcCdxLNwwOOwbT7uCJK7_wdLpCaRM-G7OkSQTUKwMFVHd-PBhLwAabwf1746dxxTt-t7sOfnt-O9ybX5snspdOkC2-PXw2CiVDCThSKbvHjvO0nVZcUE6-XZKXpsR67yLnmDSeOtNKdCCxFls1k_cWZo3m00]--></g></svg>